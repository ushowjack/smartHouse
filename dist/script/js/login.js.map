{"version":3,"sources":["login.js"],"names":["inputElem","document","querySelectorAll","forEach","FormUtil","setPlaceholder","captchaIMG","querySelector","onclick","src","Timestamp","captchaInput","onkeyup","msg","value","length","xhr","AJAXFn","createXHR","url","URL","open","onreadystatechange","readyState","status","responseText","JSON","parse","innerText","className","send","loginBtn","serialize","checkForm","inputArr","setRequestHeader","console","log","serializeInput"],"mappings":"AAAA;;;;;;AAMA;;AAEA;;;;AACA,IAAIA,yCAAgBC,SAASC,gBAAT,CAA0B,OAA1B,CAAhB,EAAJ;AACA;AACAF,UAAUG,OAAV,CAAkBC,SAASC,cAA3B;;AAEA;AACA,IAAIC,aAAaL,SAASM,aAAT,CAAuB,oBAAvB,CAAjB;AACAD,WAAWE,OAAX,GAAqB,YAAY;AAC7B,WAAOF,WAAWG,GAAX,GAAiBC,UAAUJ,WAAWG,GAArB,CAAxB;AACH,CAFD;;AAIA;AACA,IAAIE,eAAeV,SAASM,aAAT,CAAuB,uBAAvB,CAAnB;;AAEAI,aAAaC,OAAb,GAAuB,YAAY;AAC/B,QAAIC,MAAMZ,SAASM,aAAT,CAAuB,cAAvB,CAAV;AACA,QAAII,aAAaG,KAAb,CAAmBC,MAAnB,IAA6B,CAAjC,EAAoC;AAChC;AACA,YAAIC,MAAMC,OAAOC,SAAP,EAAV;AACA,YAAIC,MAASC,GAAT,yBAAgCT,aAAaG,KAAjD;AACA;AACA;AACA;AACAE,YAAIK,IAAJ,CAAS,KAAT,EAAgBF,GAAhB,EAAqB,IAArB;AACA;AACAH,YAAIM,kBAAJ,GAAyB,YAAY;AACjC,gBAAIN,IAAIO,UAAJ,IAAkB,CAAlB,IAAuBP,IAAIQ,MAAJ,IAAc,GAAzC,EAA8C;AAC1C,oBAAIC,eAAeC,KAAKC,KAAL,CAAWX,IAAIS,YAAf,CAAnB;AACA,oBAAIA,aAAaD,MAAb,KAAwB,QAA5B,EAAsC;AAClCX,wBAAIe,SAAJ,GAAgB,SAAhB;AACAf,wBAAIgB,SAAJ,GAAgB,SAAhB;AACH,iBAHD,MAGO;AACHhB,wBAAIe,SAAJ,GAAgB,SAAhB;AACAf,wBAAIgB,SAAJ,GAAgB,MAAhB;AACH;AACJ;AACJ,SAXD;AAYA;AACAb,YAAIc,IAAJ,CAAS,IAAT;AACH,KAvBD,MAuBO;AACHjB,YAAIe,SAAJ,GAAgB,EAAhB;AACH;AACJ,CA5BD;;AA8BA;AACA,IAAIG,WAAW9B,SAASM,aAAT,CAAuB,QAAvB,CAAf;AACAwB,SAASvB,OAAT,GAAmB,YAAY;AAC3BF,eAAWG,GAAX,GAAiBC,UAAUJ,WAAWG,GAArB,CAAjB;AACA,QAAII,MAAMZ,SAASM,aAAT,CAAuB,cAAvB,CAAV;AACA,QAAIyB,UAAUC,SAAV,EAAJ,EAA2B;AACvB,YAAIjB,MAAMC,OAAOC,SAAP,EAAV;AACA,YAAIgB,wCAAejC,SAASC,gBAAT,CAA0B,OAA1B,CAAf,EAAJ;AACA,YAAIiB,MAASC,GAAT,gBAAJ;;AAEAJ,YAAIK,IAAJ,CAAS,MAAT,EAAiBF,GAAjB,EAAsB,IAAtB;AACAH,YAAImB,gBAAJ,CAAqB,cAArB,EAAqC,mCAArC;AACAnB,YAAIM,kBAAJ,GAAyB,YAAY;AACjC,gBAAIN,IAAIO,UAAJ,IAAkB,CAAlB,IAAuBP,IAAIQ,MAAJ,IAAc,GAAzC,EAA8C;AAC1C,oBAAIC,eAAeC,KAAKC,KAAL,CAAWX,IAAIS,YAAf,CAAnB;AACAW,wBAAQC,GAAR,CAAYZ,YAAZ;AACA,oBAAIA,aAAaD,MAAb,KAAwB,QAA5B,EAAsC;AAClCX,wBAAIe,SAAJ,GAAgBH,aAAaZ,GAA7B;AACAA,wBAAIgB,SAAJ,GAAgB,MAAhB;AACH;AACJ;AACJ,SATD;AAUAO,gBAAQC,GAAR,CAAYL,UAAUM,cAAV,CAAyBJ,QAAzB,CAAZ;AACAlB,YAAIc,IAAJ,CAASE,UAAUM,cAAV,CAAyBJ,QAAzB,CAAT;AACH;AACJ,CAvBD","file":"login.js","sourcesContent":["/**\r\n * Created with ES6.\r\n * User: Ushow Jack/youshoujie@tomee.cn\r\n * Date: 2017/4/12\r\n * Time: 10:15\r\n */\r\n\"use strict\"\r\n\r\n//由于myForEach不是原生的遍历器，要把类数组转成数组\r\nlet inputElem = [...document.querySelectorAll(\"input\")];\r\n//Array.prototype.forEach.apply(FormUtil.setPlaceholder,inputElem);\r\ninputElem.forEach(FormUtil.setPlaceholder);\r\n\r\n//添加captcha的点击事件\r\nlet captchaIMG = document.querySelector(\"img[alt='captcha']\");\r\ncaptchaIMG.onclick = function () {\r\n    return captchaIMG.src = Timestamp(captchaIMG.src);\r\n}\r\n\r\n//the input[name='captcha'] add a keyUp event to check the captcha\r\nlet captchaInput = document.querySelector(\"input[name='captcha']\");\r\n\r\ncaptchaInput.onkeyup = function () {\r\n    let msg = document.querySelector(\".forget>span\");\r\n    if (captchaInput.value.length >= 4) {\r\n        //创建XMLHttpRequest对象\r\n        let xhr = AJAXFn.createXHR();\r\n        let url = `${URL}/captcha/captcha/${captchaInput.value}`;\r\n        //url = AJAXFn.addURLParam(url,\"captcha\",captchaInput.value);\r\n        //配置XMLHttpRequest对象\r\n        //console.log(url);\r\n        xhr.open(\"get\", url, true);\r\n        //设置回调函数\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                let responseText = JSON.parse(xhr.responseText);\r\n                if (responseText.status === \"101201\") {\r\n                    msg.innerText = \"验证码输入正确\";\r\n                    msg.className = \"success\";\r\n                } else {\r\n                    msg.innerText = \"验证码输入错误\";\r\n                    msg.className = \"warn\";\r\n                }\r\n            }\r\n        }\r\n        //发送请求\r\n        xhr.send(null);\r\n    } else {\r\n        msg.innerText = \"\";\r\n    }\r\n}\r\n\r\n//Add the form check to jump to the main web page\r\nlet loginBtn = document.querySelector(\"#login\");\r\nloginBtn.onclick = function () {\r\n    captchaIMG.src = Timestamp(captchaIMG.src);\r\n    let msg = document.querySelector(\".forget>span\");\r\n    if (serialize.checkForm()) {\r\n        let xhr = AJAXFn.createXHR();\r\n        let inputArr = [...document.querySelectorAll(\"input\")];\r\n        let url = `${URL}/logincheck`;\r\n\r\n        xhr.open(\"post\", url, true);\r\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                let responseText = JSON.parse(xhr.responseText);\r\n                console.log(responseText);\r\n                if (responseText.status === '101100') {\r\n                    msg.innerText = responseText.msg;\r\n                    msg.className = \"warn\";\r\n                }\r\n            }\r\n        }\r\n        console.log(serialize.serializeInput(inputArr))\r\n        xhr.send(serialize.serializeInput(inputArr));\r\n    }\r\n}"]}