{"version":3,"sources":["login.js"],"names":["inputElem","document","querySelectorAll","forEach","FormUtil","setPlaceholder","captchaIMG","onclick","src","Timestamp","captchaInput","querySelector","onkeyup","value","length","msg","xhr","open","url","onreadystatechange","readyState","status","JSON","parse","responseText","innerText","className","send","loginBtn","checkForm","AJAXFn","serialize","inputArr","setRequestHeader","console","log","serializeInput"],"mappings":"AAMA,sJAGA,GAAIA,cAAAA,OAAAA,mBAAgBC,SAASC,iBAAiB,UAE9CF,WAAUG,QAAQC,SAASC,eAA3BL,IAAAA,YAAAC,SAAkBG,cAASC,qBAI3BC,YAAWC,QAAU,WAFrB,MAAAD,YAAAE,IAAAC,UAAAH,WAAAE,KAIC,IAFDE,cAAAT,SAAAU,cAAA,wBAIAD,cAAAE,QAAA,WACIF,GAAAA,GAAAA,SAAeT,cAASU,eAIxB,IAAID,aAAaG,MAAMC,QAAU,EAAG,CADhCC,GAAAA,GAAMd,OAASU,YACfD,EAAaG,IAAbH,oBAAgCA,aAAAG,KAIhCG,GAAAC,KAAA,MAAAC,GAAA,GAEAF,EAAAG,mBAAA,WACIF,GAAJ,GAAAD,EAASI,YAAT,KAAAJ,EAAAK,OAAA,CAEyB,WADzBC,KAAAC,MAAAP,EAAAQ,cACyBH,QACbD,EAAAA,UAAJ,UACII,EAAAA,UAAeF,YAEfP,EAAIU,UAAY,UAChBV,EAAIW,UAAY,UAKvBV,EAAAW,KAAA,UAELZ,GAAAU,UAAA,GAKP,IA5BDG,UAAA3B,SAAAU,cAAA,SAgCAiB,UAASrB,QAAU,WAFnBD,WAAAE,IAAAC,UAAAH,WAAAE,IACIoB,IAAAA,GAAAA,SAAW3B,cAAA,eACf2B,IAAAA,UAAAC,YAA+B,CAC3BvB,GAAAA,GAAAwB,OAAiBrB,YACbM,KAAAA,OAAAA,mBAAeJ,SAATT,iBAAV,WACI6B,EAAUF,IAAVE,aAEAf,GAAIgB,KAAAA,OAAAA,GAAAA,GACJhB,EAAIE,iBAAA,eAAJ,qCAIAF,EAAIG,mBAAqB,WAFrBF,GAAJ,GAAAD,EAASI,YAAT,KAAAJ,EAAAK,OAAA,CACIY,GAAAA,GAAiBX,KAAAC,MAAgBP,EAAAQ,aACjCL,SAAAA,IAAAA,GAC+BE,WAAvBD,EAAJC,SACIG,EAAAA,UAAeF,EAAWN,IAC9BkB,EAAQC,UAAIX,UAIXU,QAAAC,IAAAJ,UAAAK,eAAAJ,IACJhB,EAAAW,KAAAI,UAAAK,eAAAJ","file":"login.js","sourcesContent":["/**\r\n * Created with ES6.\r\n * User: Ushow Jack/youshoujie@tomee.cn\r\n * Date: 2017/4/12\r\n * Time: 10:15\r\n */\r\n\"use strict\"\r\n\r\n//由于myForEach不是原生的遍历器，要把类数组转成数组\r\nlet inputElem = [...document.querySelectorAll(\"input\")];\r\n//Array.prototype.forEach.apply(FormUtil.setPlaceholder,inputElem);\r\ninputElem.forEach(FormUtil.setPlaceholder);\r\n\r\n//添加captcha的点击事件\r\nlet captchaIMG = document.querySelector(\"img[alt='captcha']\");\r\ncaptchaIMG.onclick = function () {\r\n    return captchaIMG.src = Timestamp(captchaIMG.src);\r\n}\r\n\r\n//the input[name='captcha'] add a keyUp event to check the captcha\r\nlet captchaInput = document.querySelector(\"input[name='captcha']\");\r\n\r\ncaptchaInput.onkeyup = function () {\r\n    let msg = document.querySelector(\".forget>span\");\r\n    if (captchaInput.value.length >= 4) {\r\n        //创建XMLHttpRequest对象\r\n        let xhr = AJAXFn.createXHR();\r\n        let url = `${URL}/captcha/captcha/${captchaInput.value}`;\r\n        //url = AJAXFn.addURLParam(url,\"captcha\",captchaInput.value);\r\n        //配置XMLHttpRequest对象\r\n        //console.log(url);\r\n        xhr.open(\"get\", url, true);\r\n        //设置回调函数\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                let responseText = JSON.parse(xhr.responseText);\r\n                if (responseText.status === \"101201\") {\r\n                    msg.innerText = \"验证码输入正确\";\r\n                    msg.className = \"success\";\r\n                } else {\r\n                    msg.innerText = \"验证码输入错误\";\r\n                    msg.className = \"warn\";\r\n                }\r\n            }\r\n        }\r\n        //发送请求\r\n        xhr.send(null);\r\n    } else {\r\n        msg.innerText = \"\";\r\n    }\r\n}\r\n\r\n//Add the form check to jump to the main web page\r\nlet loginBtn = document.querySelector(\"#login\");\r\nloginBtn.onclick = function () {\r\n    captchaIMG.src = Timestamp(captchaIMG.src);\r\n    let msg = document.querySelector(\".forget>span\");\r\n    if (serialize.checkForm()) {\r\n        let xhr = AJAXFn.createXHR();\r\n        let inputArr = [...document.querySelectorAll(\"input\")];\r\n        let url = `${URL}/logincheck`;\r\n\r\n        xhr.open(\"post\", url, true);\r\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                let responseText = JSON.parse(xhr.responseText);\r\n                console.log(responseText);\r\n                if (responseText.status === '101100') {\r\n                    msg.innerText = responseText.msg;\r\n                    msg.className = \"warn\";\r\n                }\r\n            }\r\n        }\r\n        console.log(serialize.serializeInput(inputArr))\r\n        xhr.send(serialize.serializeInput(inputArr));\r\n    }\r\n}"]}