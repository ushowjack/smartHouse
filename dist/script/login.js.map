{"version":3,"sources":["login.js"],"names":["inputElem","document","querySelectorAll","forEach","FormUtil","setPlaceholder","captchaIMG","onclick","src","Timestamp","captchaInput","querySelector","onkeyup","value","length","msg","xhr","open","url","onreadystatechange","readyState","status","JSON","parse","responseText","innerText","className","send","loginBtn","checkForm","AJAXFn","serialize","inputArr","setRequestHeader","console","log","serializeInput"],"mappings":"AAMA,sJAGA,GAAIA,cAAAA,OAAAA,mBAAgBC,SAASC,iBAAiB,UAE9CF,WAAUG,QAAQC,SAASC,eAA3BL,IAAAA,YAAAC,SAAkBG,cAASC,qBAI3BC,YAAWC,QAAU,WAFrB,MAAAD,YAAAE,IAAAC,UAAAH,WAAAE,KAIC,IAFDE,cAAAT,SAAAU,cAAA,wBAIAD,cAAAE,QAAA,WACIF,GAAAA,GAAAA,SAAeT,cAASU,eAIxB,IAAID,aAAaG,MAAMC,QAAU,EAAG,CADhCC,GAAAA,GAAMd,OAASU,YACfD,EAAaG,IAAbH,oBAAgCA,aAAAG,KAIhCG,GAAAC,KAAA,MAAAC,GAAA,GAEAF,EAAAG,mBAAA,WACIF,GAAJ,GAAAD,EAASI,YAAT,KAAAJ,EAAAK,OAAA,CAEyB,WADzBC,KAAAC,MAAAP,EAAAQ,cACyBH,QACbD,EAAAA,UAAJ,UACII,EAAAA,UAAeF,YAEfP,EAAIU,UAAY,UAChBV,EAAIW,UAAY,UAKvBV,EAAAW,KAAA,UAELZ,GAAAU,UAAA,GAKP,IA5BDG,UAAA3B,SAAAU,cAAA,SAgCAiB,UAASrB,QAAU,WAFnBD,WAAAE,IAAAC,UAAAH,WAAAE,IACIoB,IAAAA,GAAAA,SAAW3B,cAAA,eACf2B,IAAAA,UAAAC,YAA+B,CAC3BvB,GAAAA,GAAAwB,OAAiBrB,YACbM,KAAAA,OAAAA,mBAAeJ,SAATT,iBAAV,WACI6B,EAAUF,IAAVE,aAEAf,GAAIgB,KAAAA,OAAAA,GAAAA,GACJhB,EAAIE,iBAAA,eAAJ,qCAIAF,EAAIG,mBAAqB,WAFrBF,GAAJ,GAAAD,EAASI,YAAT,KAAAJ,EAAAK,OAAA,CACIY,GAAAA,GAAiBX,KAAAC,MAAgBP,EAAAQ,aACjCL,SAAAA,IAAAA,GAC+BE,WAAvBD,EAAJC,SACIG,EAAAA,UAAeF,EAAWN,IAC9BkB,EAAQC,UAAIX,UAIXU,QAAAC,IAAAJ,UAAAK,eAAAJ,IACJhB,EAAAW,KAAAI,UAAAK,eAAAJ","file":"login.js","sourcesContent":["/**\n * Created with ES6.\n * User: Ushow Jack/youshoujie@tomee.cn\n * Date: 2017/4/12\n * Time: 10:15\n */\n\"use strict\"\n\n//由于myForEach不是原生的遍历器，要把类数组转成数组\nlet inputElem = [...document.querySelectorAll(\"input\")];\n//Array.prototype.forEach.apply(FormUtil.setPlaceholder,inputElem);\ninputElem.forEach(FormUtil.setPlaceholder);\n\n//添加captcha的点击事件\nlet captchaIMG = document.querySelector(\"img[alt='captcha']\");\ncaptchaIMG.onclick = function () {\n    return captchaIMG.src = Timestamp(captchaIMG.src);\n}\n\n//the input[name='captcha'] add a keyUp event to check the captcha\nlet captchaInput = document.querySelector(\"input[name='captcha']\");\n\ncaptchaInput.onkeyup = function () {\n    let msg = document.querySelector(\".forget>span\");\n    if (captchaInput.value.length >= 4) {\n        //创建XMLHttpRequest对象\n        let xhr = AJAXFn.createXHR();\n        let url = `${URL}/captcha/captcha/${captchaInput.value}`;\n        //url = AJAXFn.addURLParam(url,\"captcha\",captchaInput.value);\n        //配置XMLHttpRequest对象\n        //console.log(url);\n        xhr.open(\"get\", url, true);\n        //设置回调函数\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == 4 && xhr.status == 200) {\n                let responseText = JSON.parse(xhr.responseText);\n                if (responseText.status === \"101201\") {\n                    msg.innerText = \"验证码输入正确\";\n                    msg.className = \"success\";\n                } else {\n                    msg.innerText = \"验证码输入错误\";\n                    msg.className = \"warn\";\n                }\n            }\n        }\n        //发送请求\n        xhr.send(null);\n    } else {\n        msg.innerText = \"\";\n    }\n}\n\n//Add the form check to jump to the main web page\nlet loginBtn = document.querySelector(\"#login\");\nloginBtn.onclick = function () {\n    captchaIMG.src = Timestamp(captchaIMG.src);\n    let msg = document.querySelector(\".forget>span\");\n    if (serialize.checkForm()) {\n        let xhr = AJAXFn.createXHR();\n        let inputArr = [...document.querySelectorAll(\"input\")];\n        let url = `${URL}/logincheck`;\n\n        xhr.open(\"post\", url, true);\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState == 4 && xhr.status == 200) {\n                let responseText = JSON.parse(xhr.responseText);\n                console.log(responseText);\n                if (responseText.status === '101100') {\n                    msg.innerText = responseText.msg;\n                    msg.className = \"warn\";\n                }\n            }\n        }\n        console.log(serialize.serializeInput(inputArr))\n        xhr.send(serialize.serializeInput(inputArr));\n    }\n}"]}